(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[16],{9189:function(e,t,n){Promise.resolve().then(n.bind(n,1854))},3377:function(e,t,n){"use strict";n.d(t,{L:function(){return o},c:function(){return s}});var a=n(5474),r=n(666);function o(){return localStorage.getItem(r.px)}async function i(){return await (0,a.gw)(2e3),{code:"code",message:"Mock",result:{nickName:"Mock",token:"Mock"}}}async function s(e,t){if(r.M7)return await i();let n=await fetch("".concat(r.FH,"/member/login"),{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({userName:e,password:t})});if(!n.ok)throw Error("HTTP error! status: ".concat(n.status));return await n.json()}},1854:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return D}});var a=n(9268),r=n(5474),o=n(666),i=n(3377);async function s(){return await (0,r.gw)(2e3),{code:"mock",message:"mock",result:[{id:"1",caseName:"caseName",caseId:"caseId",describe:"describe",operateTime:"operationTime",operator:"operator",reply:"reply",updateTime:"updateTime",uploadTime:"uploadTime",userId:"userId"}]}}async function c(){if(o.M7)return await s();let e=await fetch("".concat(o.FH,"/management/reports"),{method:"GET",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat((0,i.L)())}});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));return await e.json()}async function l(){return await (0,r.gw)(2e3),{code:"mock",message:"mock",result:{isSuccess:!0}}}async function d(e){if(o.M7)return await l();let t=await fetch("".concat(o.FH,"/management/report/").concat(e),{method:"DELETE",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat((0,i.L)())}});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));return await t.json()}async function u(){return await (0,r.gw)(2e3),{code:"mock",message:"mock",result:{imageURLs:["https://hips.hearstapps.com/hmg-prod/images/dog-puppy-on-garden-royalty-free-image-1586966191.jpg?crop=0.752xw:1.00xh;0.175xw,0&resize=1200:*","https://img.freepik.com/free-photo/puppy-that-is-walking-snow_1340-37228.jpg","https://hips.hearstapps.com/hmg-prod/images/dog-puppy-on-garden-royalty-free-image-1586966191.jpg?crop=0.752xw:1.00xh;0.175xw,0&resize=1200:*","https://img.freepik.com/free-photo/puppy-that-is-walking-snow_1340-37228.jpg","https://hips.hearstapps.com/hmg-prod/images/dog-puppy-on-garden-royalty-free-image-1586966191.jpg?crop=0.752xw:1.00xh;0.175xw,0&resize=1200:*","https://img.freepik.com/free-photo/puppy-that-is-walking-snow_1340-37228.jpg"],describe:"mock",replies:[{reply:"mock",operateTime:"mock",operator:"mock"},{reply:"mock",operateTime:"mock",operator:"mock"},{reply:"mock",operateTime:"mock",operator:"mock"},{reply:"mock",operateTime:"mock",operator:"mock"}]}}}async function m(e,t){if(o.M7)return await u();let n=await fetch("".concat(o.FH,"/management/report/detail"),{method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat((0,i.L)())},body:JSON.stringify({id:e,caseId:t})});if(!n.ok)throw Error("HTTP error! status: ".concat(n.status));return await n.json()}async function p(){return await (0,r.gw)(2e3),{code:"mock",message:"mock",result:{isSuccess:!0}}}async function h(e,t){if(o.M7)return await p();let n=await fetch("".concat(o.FH,"/management/upload/reply"),{method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat((0,i.L)())},body:JSON.stringify({id:e,reply:t})});if(!n.ok)throw Error("HTTP error! status: ".concat(n.status));return await n.json()}var f=n(6831),g=n(7454),y=n(9748),_=n(1263),x=n(7007),k=n(8302),w=n(1904),j=n(6006),b=n(7909),v=n.n(b),N=n(6462),C=n(3368),T=n(7833),S=n.n(T),M=n(8683),Z=n.n(M);function I(e){let{className:t,account:n,time:o,children:i}=e;return(0,a.jsxs)("div",{className:Z()(S().comment,t),children:[(0,a.jsxs)("div",{className:S().head,children:[(0,a.jsx)("p",{children:n}),(0,a.jsx)("p",{children:o&&(0,r.rn)(o)})]}),(0,a.jsx)("p",{children:i})]})}var P=n(9153);let L=Number(v().imageWidth),E=Number(v().imageHeight),z=(0,j.memo)(()=>{var e,t;let n=(0,j.useMemo)(()=>[{dataIndex:"id",title:"ID"},{dataIndex:"caseName",title:"回報古蹟名稱"},{dataIndex:"describe",title:"回報描述"},{dataIndex:"userId",title:"上傳用戶帳號"},{dataIndex:"uploadTime",title:"上傳時間",render:e=>(0,r.rn)(e)},{dataIndex:"reply",title:"進度回覆"},{dataIndex:"operator",title:"操作者"},{dataIndex:"operateTime",title:"操作時間",render:e=>(0,r.rn)(e)},{title:"操作",render:(e,t)=>{let{id:n,caseId:r}=t;return(0,a.jsxs)("div",{className:v().operation,children:[(0,a.jsx)(f.Z,{looks:P.L.primary,onClick:()=>{b(!0),S(n),Z(r),H(n,r)},children:"回覆"}),(0,a.jsx)(f.Z,{looks:P.L.danger,onClick:()=>{x.Z.confirm({content:(0,a.jsx)("div",{className:v().deleteModalContent,children:(0,a.jsx)("p",{children:"是否確認刪除？"})}),onOk:async()=>{await u(n)},okButtonProps:{looks:P.L.danger}})},children:"刪除"})]})}}],[]),o=(0,j.useCallback)(async()=>{try{let e=await c();return e.result}catch(e){return[]}},[]),{loading:i,data:s,run:l}=(0,w.Q)(o,{manual:!1}),u=(0,j.useCallback)(async e=>{try{await d(e)}catch(e){}l()},[l]),[p,b]=(0,j.useState)(!1),[T,S]=(0,j.useState)(""),[M,Z]=(0,j.useState)(""),{loading:z,data:D,run:H,reset:U}=(0,w.Q)(async(e,t)=>{try{let n=await m(e,t),a={...n.result,imageUrlConfigs:n.result.imageURLs.map(e=>({id:(0,N.Z)(),url:e})),replyConfigs:n.result.replies.map(e=>{let{operator:t,operateTime:n,reply:a}=e;return{id:(0,N.Z)(),operator:t,operateTime:n,reply:a}})};return a}catch(e){}}),[B,A]=(0,j.useState)(""),{loading:R,run:O}=(0,w.Q)(async()=>{if(B)try{await h(T,B),A(""),H(T,M),l()}catch(e){}}),[F,Q]=(0,j.useState)(!1),[G,V]=(0,j.useState)("");return(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(k.Z,{columns:n,dataSource:s,loading:i}),(0,a.jsx)(x.Z,{open:p,width:440,onClose:()=>{b(!1),S(""),Z(""),U()},children:(0,a.jsx)(C.Z,{spinning:z,children:(0,a.jsxs)("div",{className:v().reportModalContent,children:[(0,a.jsx)("p",{className:v().title,children:"回報圖片"}),(0,a.jsx)("div",{className:v().imageArea,children:null==D?void 0:null===(e=D.imageUrlConfigs)||void 0===e?void 0:e.map(e=>{let{id:t,url:n}=e;return(0,a.jsx)("div",{className:v().image,onClick:()=>{Q(!0),V(n)},children:(0,a.jsx)(g.Z,{src:n,width:L,height:E,alt:"圖片"})},t)})}),(0,a.jsx)("p",{className:v().title,children:"回報描述"}),(null==D?void 0:D.describe)&&(0,a.jsx)("p",{className:v().describe,children:D.describe}),(0,a.jsx)("div",{className:v().comments,children:null==D?void 0:null===(t=D.replyConfigs)||void 0===t?void 0:t.map(e=>{let{id:t,operator:n,operateTime:r,reply:o}=e;return(0,a.jsx)(I,{time:r,account:n,children:o},t)})}),(0,a.jsx)(y.Z,{onSubmit:O,children:(0,a.jsxs)("div",{className:v().replyArea,children:[(0,a.jsx)(_.Z,{value:B,onChange:A,disabled:R,onKeyDown:e=>{"Enter"===e.key&&""===B&&e.preventDefault()}}),(0,a.jsx)(f.Z,{htmlType:"submit",loading:R,looks:P.L.dark,children:"回覆"})]})})]})})}),(0,a.jsx)(x.Z,{open:F,onClose:()=>{Q(!1),V("")},children:(0,a.jsx)(g.Z,{src:G,width:200,height:200,alt:"圖片"})})]})});z.displayName="RestorationPage";var D=z},7454:function(e,t,n){"use strict";var a=n(9268),r=n(6394),o=n.n(r),i=n(6006),s=n(7613),c=n.n(s);let l=(0,i.memo)((0,i.forwardRef)((e,t)=>{let{src:n,...r}=e;return(0,a.jsx)(o(),{...r,ref:t,unoptimized:!0,src:"string"==typeof n&&n.startsWith("/")&&c().basePath?"".concat(c().basePath).concat(n):n})}));l.displayName="CustomImage",t.Z=l},6831:function(e,t,n){"use strict";var a=n(9268),r=n(6006),o=n(3368),i=n(1576),s=n.n(i),c=n(8683),l=n.n(c),d=n(9153);let u=(0,r.memo)(e=>{let{className:t,children:n,loading:r,disabled:i,htmlType:c,onClick:u,looks:m,icon:p}=e;return(0,a.jsxs)("button",{className:"close"===p?l()("bg-close bg-4 h-8 w-8 bg-center bg-no-repeat opacity-50",t):l()(s().button,{[s().primary]:m===d.L.primary,[s().danger]:m===d.L.danger,[s().dark]:m===d.L.dark},t),disabled:r||i,onClick:u,type:c,children:[r&&(0,a.jsx)(o.Z,{size:o.v.small})," ",n]})});u.displayName="Button",t.Z=u},9748:function(e,t,n){"use strict";n.d(t,{S:function(){return a}});var a,r=n(9268),o=n(6006),i=n(9924),s=n.n(i),c=n(8683),l=n.n(c),d=n(5474),u=n(2624);(a||(a={})).horizontal="horizontal";let m=(0,o.memo)(e=>{let{layout:t,onSubmit:n,children:i}=e,[c,m]=(0,o.useState)(!1);return(0,r.jsx)("form",{className:l()({[s().horizontal]:t===a.horizontal}),onSubmit:async e=>{if(e.preventDefault(),!c&&n){m(!0);try{n instanceof d.sG?await n():n()}catch(e){e instanceof Error?(0,d.cM)(e.message,u.L.console):(0,d.cM)(e,u.L.console)}finally{m(!1)}}},children:i})});m.displayName="Form",t.Z=m},1263:function(e,t,n){"use strict";var a=n(9268),r=n(6006),o=n(3115),i=n.n(o);let s=(0,r.memo)((0,r.forwardRef)((e,t)=>{let{type:n,value:o,onChange:s,onKeyDown:c,disabled:l,placeholder:d}=e,[u,m]=(0,r.useState)(o||"");return(0,a.jsx)("input",{className:i().input,type:n,value:u,onChange:e=>{let t=e.target.value;m(t),null==s||s(t)},onKeyDown:c,disabled:l,placeholder:d,ref:t})}));s.displayName="Input",t.Z=s},7007:function(e,t,n){"use strict";var a=n(9268),r=n(6006),o=n(8431),i=n(3194),s=n(4209),c=n.n(s),l=n(6831);function d(e){let{title:t,children:n,width:r,isCloseButtonShow:o,maskClosable:i,onClose:s}=e;return(0,a.jsx)("div",{className:c().backgroundMask,onClick:i?s:void 0,children:(0,a.jsxs)("div",{className:"my-12 divide-y divide-solid rounded bg-white",style:{width:r},onClick:e=>{e.stopPropagation()},children:[t&&(0,a.jsxs)("div",{className:"flex items-center justify-between p-4 text-xl font-medium",children:[t,o&&(0,a.jsx)(l.Z,{className:"p-2",icon:"close",onClick:s})]}),n&&(0,a.jsx)("div",{className:"p-4",children:n})]})})}let u=(0,r.memo)(e=>{let{title:t,children:n,open:r=!1,width:i,isCloseButtonShow:s,maskClosable:c=!0,onClose:l}=e;return r&&(0,o.createPortal)((0,a.jsx)(d,{title:t,width:i,isCloseButtonShow:s,maskClosable:c,onClose:l,children:n}),document.body)});u.displayName="Modal";let m=(0,r.memo)(e=>{let{content:t,onOk:n,okButtonProps:o,onCancel:i,cancelButtonProps:s}=e,[u,m]=(0,r.useState)(!1),[p,h]=(0,r.useState)(!1),f=(0,r.useCallback)(async()=>{m(!0),await (null==n?void 0:n()),m(!1)},[n]),g=(0,r.useCallback)(async()=>{h(!0),await (null==i?void 0:i()),h(!1)},[i]);return(0,a.jsxs)(d,{children:[t,(0,a.jsxs)("div",{className:c().buttonGroup,children:[(0,a.jsx)(l.Z,{...o,loading:u,disabled:p,onClick:f,children:"確定"}),(0,a.jsx)(l.Z,{...s,loading:p,disabled:u,onClick:g,children:"取消"})]})]})});m.displayName="ConfirmModal";let p="confirmModal";u.confirm=e=>{let{content:t,onOk:n,okButtonProps:r,onCancel:o,cancelButtonProps:s}=e,c=document.getElementById(p);c||((c=document.createElement("div")).id=p),document.body.appendChild(c);let l=(0,i.createRoot)(c);l.render((0,a.jsx)(m,{content:t,onOk:async()=>{try{await (null==n?void 0:n()),l.unmount()}catch(e){}},okButtonProps:r,onCancel:async()=>{await (null==o?void 0:o()),l.unmount()},cancelButtonProps:s}))},t.Z=u},3368:function(e,t,n){"use strict";n.d(t,{v:function(){return r}});var a,r,o=n(9268),i=n(6006),s=n(722),c=n.n(s),l=n(8683),d=n.n(l);(a=r||(r={})).small="small",a.medium="medium";let u=(0,i.memo)(e=>{let{spinning:t=!0,size:n=r.medium,expand:a=!1,children:i}=e;return t?(0,o.jsxs)("div",{className:d()(c().wrapper,{[c().expand]:a},{[c().small]:n===r.small,[c().medium]:n===r.medium}),children:[i,(0,o.jsx)("div",{className:d()(c().overlay,{[c().block]:!i}),children:(0,o.jsx)("div",{className:c().spinner})})]}):i});u.displayName="Spin",t.Z=u},8302:function(e,t,n){"use strict";var a=n(9268),r=n(6006),o=n(6462),i=n(3368),s=n(6279),c=n.n(s),l=n(8683),d=n.n(l);let u=(0,r.memo)(e=>{let{className:t,rowKeyName:n="id",columns:s=[],dataSource:l=[],loading:u=!1}=e,m=(0,r.useMemo)(()=>s.map(e=>[e.dataIndex||(0,o.Z)(),e]),[s]),p=(0,r.useMemo)(()=>(0,a.jsx)("tr",{children:m.map(e=>{let[t,{title:n}]=e;return(0,a.jsx)("th",{children:n},t)})}),[m]),h=(0,r.useMemo)(()=>l.map(e=>(0,a.jsx)("tr",{children:m.map(t=>{let[n,{dataIndex:r,render:o}]=t;return(0,a.jsx)("td",{children:o?o(r&&e[r],e):r&&e[r]},n)})},e[n])),[m,l,n]);return(0,a.jsx)(i.Z,{spinning:u,expand:!0,children:(0,a.jsx)("div",{className:d()(c().wrapper,t),children:(0,a.jsx)("table",{className:d()(c().table),children:(0,a.jsxs)("tbody",{children:[p,h]})})})})});u.displayName="Table",t.Z=u},1904:function(e,t,n){"use strict";n.d(t,{Q:function(){return r}});var a=n(6006);function r(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{manual:!0},n=(0,a.useRef)(t.manual),[r,o]=(0,a.useState)({loading:!1,data:void 0}),i=(0,a.useCallback)(async function(){for(var t=arguments.length,n=Array(t),a=0;a<t;a++)n[a]=arguments[a];o(e=>{let{data:t}=e;return{loading:!0,data:t}});let r=await e(...n);return o({loading:!1,data:r}),r},[e]),s=(0,a.useRef)(i),c=(0,a.useCallback)(()=>{o({loading:!1,data:void 0})},[]);return(0,a.useEffect)(()=>{n.current||s.current(...[])},[]),(0,a.useMemo)(()=>({run:i,reset:c,...r}),[i,c,r])}},7613:function(e){"use strict";e.exports={output:"export",basePath:"/historic-site-portal-demo"}},2624:function(e,t,n){"use strict";var a,r;n.d(t,{L:function(){return a}}),(r=a||(a={})).none="none",r.console="console",r.message="message"},9153:function(e,t,n){"use strict";var a,r;n.d(t,{L:function(){return a}}),(r=a||(a={})).primary="primary",r.dark="dark",r.danger="danger"},666:function(e,t,n){"use strict";n.d(t,{FH:function(){return a},M7:function(){return o},px:function(){return r}});let a="https://oldcity-backend.azurewebsites.net",r="token",o=!1},5474:function(e,t,n){"use strict";n.d(t,{cM:function(){return s},gw:function(){return i},rn:function(){return c},sG:function(){return l}});var a=n(2624),r=n(5326),o=n.n(r);let i=async e=>{await new Promise(t=>setTimeout(t,e))},s=(e,t)=>{switch(t){case a.L.none:break;case a.L.console:case a.L.message:console.log(e)}};function c(e){return e?o()(e).format("YYYY-MM-DD HH:mm:ss"):"--"}let l=(async()=>{}).constructor},7833:function(e){e.exports={comment:"Comment_comment__58lVE",head:"Comment_head__Io4E1"}},7909:function(e){e.exports={imageWidth:"60",imageHeight:"60",operation:"page_operation__PBqQk",deleteModalContent:"page_deleteModalContent__Htwop",reportModalContent:"page_reportModalContent__Vz33w",title:"page_title__LbX8Q",imageArea:"page_imageArea__kDQsI",image:"page_image__U9lRb",describe:"page_describe__3o8KA",comments:"page_comments__kR8Jq",replyArea:"page_replyArea__PzWPk"}},1576:function(e){e.exports={button:"Button_button__kd7e2",primary:"Button_primary__Nhi6i",danger:"Button_danger__214td",dark:"Button_dark__Djc0e"}},9924:function(e){e.exports={horizontal:"Form_horizontal___Dh6K"}},3115:function(e){e.exports={input:"Input_input__Wt6t_"}},4209:function(e){e.exports={backgroundMask:"Modal_backgroundMask__9WqVi",buttonGroup:"Modal_buttonGroup__PS_fc"}},722:function(e){e.exports={wrapper:"Spin_wrapper___n_bZ",expand:"Spin_expand__GPcNO",overlay:"Spin_overlay__oF_f6",block:"Spin_block__lUtsH",spinner:"Spin_spinner__jriaU",spin:"Spin_spin__j4j0X",small:"Spin_small__YbUV6",medium:"Spin_medium__fgQDT"}},6279:function(e){e.exports={wrapper:"Table_wrapper__qyAKN",table:"Table_table__D6QPq"}},6462:function(e,t,n){"use strict";let a;n.d(t,{Z:function(){return l}});let r="undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var o={randomUUID:r};let i=new Uint8Array(16);function s(){if(!a&&!(a="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(i)}let c=[];for(let e=0;e<256;++e)c.push((e+256).toString(16).slice(1));var l=function(e,t,n){if(o.randomUUID&&!t&&!e)return o.randomUUID();e=e||{};let a=e.random||(e.rng||s)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=a[e];return t}return function(e,t=0){return(c[e[t+0]]+c[e[t+1]]+c[e[t+2]]+c[e[t+3]]+"-"+c[e[t+4]]+c[e[t+5]]+"-"+c[e[t+6]]+c[e[t+7]]+"-"+c[e[t+8]]+c[e[t+9]]+"-"+c[e[t+10]]+c[e[t+11]]+c[e[t+12]]+c[e[t+13]]+c[e[t+14]]+c[e[t+15]]).toLowerCase()}(a)}}},function(e){e.O(0,[550,720,253,488,744],function(){return e(e.s=9189)}),_N_E=e.O()}]);