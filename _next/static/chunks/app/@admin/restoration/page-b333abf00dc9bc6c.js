(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[16],{9189:function(e,t,n){Promise.resolve().then(n.bind(n,1854))},3377:function(e,t,n){"use strict";n.d(t,{L:function(){return o},c:function(){return s}});var r=n(956),a=n(2105);function o(){return localStorage.getItem(a.px)}async function i(){return await (0,r.gw)(2e3),{code:"code",message:"Mock",result:{nickName:"Mock",token:"Mock"}}}async function s(e,t){if(a.M7)return await i();let n=await fetch("".concat(a.FH,"/member/login"),{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify({userName:e,password:t})});if(!n.ok)throw Error("HTTP error! status: ".concat(n.status));return await n.json()}},1854:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return M}});var r=n(9268),a=n(956),o=n(2105),i=n(3377);async function s(){return await (0,a.gw)(2e3),{code:"mock",message:"mock",result:[{id:"1",caseName:"caseName",caseId:"caseId",describe:"describe",operateTime:"operationTime",operator:"operator",reply:"reply",updateTime:"updateTime",uploadTime:"uploadTime",userId:"userId"}]}}async function c(){if(o.M7)return await s();let e=await fetch("".concat(o.FH,"/management/reports"),{method:"GET",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat((0,i.L)())}});if(!e.ok)throw Error("HTTP error! status: ".concat(e.status));return await e.json()}async function l(){return await (0,a.gw)(2e3),{code:"mock",message:"mock",result:{isSuccess:!0}}}async function u(e){if(o.M7)return await l();let t=await fetch("".concat(o.FH,"/management/report/").concat(e),{method:"DELETE",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat((0,i.L)())}});if(!t.ok)throw Error("HTTP error! status: ".concat(t.status));return await t.json()}async function d(){return await (0,a.gw)(2e3),{code:"mock",message:"mock",result:{imageURLs:["https://hips.hearstapps.com/hmg-prod/images/dog-puppy-on-garden-royalty-free-image-1586966191.jpg?crop=0.752xw:1.00xh;0.175xw,0&resize=1200:*","https://img.freepik.com/free-photo/puppy-that-is-walking-snow_1340-37228.jpg"],describe:"mock",replies:[{reply:"mock",operateTime:"mock",operator:"mock"}]}}}async function m(e,t){if(o.M7)return await d();let n=await fetch("".concat(o.FH,"/management/report/detail"),{method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat((0,i.L)())},body:JSON.stringify({id:e,caseId:t})});if(!n.ok)throw Error("HTTP error! status: ".concat(n.status));return await n.json()}async function p(){return await (0,a.gw)(2e3),{code:"mock",message:"mock",result:{isSuccess:!0}}}async function f(e,t){if(o.M7)return await p();let n=await fetch("".concat(o.FH,"/management/upload/reply"),{method:"POST",mode:"cors",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat((0,i.L)())},body:JSON.stringify({id:e,reply:t})});if(!n.ok)throw Error("HTTP error! status: ".concat(n.status));return await n.json()}var h=n(5493),g=n(7454),y=n(2392),x=n(6917),k=n(9333),w=n(6519),j=n(1904),b=n(6006),v=n(9236),_=n.n(v),C=n(6462),S=n(4308);function T(e){let{account:t,time:n,children:a}=e;return(0,r.jsxs)("div",{children:[(0,r.jsx)("p",{children:t}),(0,r.jsx)("p",{children:n}),(0,r.jsx)("p",{children:a})]})}let N=Number(_().imageWidth),Z=Number(_().imageHeight),I=(0,b.memo)(()=>{var e,t;let n=(0,b.useMemo)(()=>[{dataIndex:"id",title:"ID"},{dataIndex:"caseName",title:"回報古蹟名稱"},{dataIndex:"describe",title:"回報描述"},{dataIndex:"userId",title:"上傳用戶帳號"},{dataIndex:"uploadTime",title:"上傳時間"},{dataIndex:"reply",title:"進度回覆"},{dataIndex:"operator",title:"操作者"},{dataIndex:"operateTime",title:"操作時間"},{title:"操作",render:(e,t)=>{let{id:n,caseId:a}=t;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(h.Z,{onClick:()=>{z(!0),U(n),F(a),D(n,a)},children:"回覆"}),(0,r.jsx)(h.Z,{onClick:()=>{d(!0),v(n)},children:"刪除"})]})}}],[]),a=(0,b.useCallback)(async()=>{try{let e=await c();return e.result}catch(e){return[]}},[]),{loading:o,data:i,run:s}=(0,j.Q)(a,{manual:!1}),[l,d]=(0,b.useState)(!1),[p,v]=(0,b.useState)(""),[_,I]=(0,b.useState)(!1),M=(0,b.useCallback)(async()=>{I(!0);try{await u(p)}catch(e){}I(!1),d(!1),await s()},[p,s]),E=(0,b.useCallback)(async()=>{v(""),d(!1)},[]),[L,z]=(0,b.useState)(!1),[P,U]=(0,b.useState)(""),[H,F]=(0,b.useState)(""),{loading:R,data:B,run:D}=(0,j.Q)(async(e,t)=>{try{let n=await m(e,t),r={...n.result,imageUrlConfigs:n.result.imageURLs.map(e=>({id:(0,C.Z)(),url:e})),replyConfigs:n.result.replies.map(e=>{let{operator:t,operateTime:n,reply:r}=e;return{id:(0,C.Z)(),operator:t,operateTime:n,reply:r}})};return r}catch(e){}}),[O,V]=(0,b.useState)(""),{loading:A,run:Q}=(0,j.Q)(async()=>{try{await f(P,O),V(""),D(P,H)}catch(e){}});return console.log(B),(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(w.Z,{columns:n,dataSource:i,loading:o}),(0,r.jsxs)(k.Z,{open:l,maskClosable:!1,onClose:()=>{d(!1)},children:[(0,r.jsx)("p",{children:"是否確認刪除？"}),(0,r.jsx)(h.Z,{loading:_,onClick:M,children:"確定"}),(0,r.jsx)(h.Z,{disabled:_,onClick:E,children:"取消"})]}),(0,r.jsx)(k.Z,{open:L,onClose:()=>{z(!1),U(""),F("")},children:(0,r.jsxs)(S.Z,{spinning:R,children:[(0,r.jsx)("p",{children:"回報圖片"}),(0,r.jsx)("div",{children:null==B?void 0:null===(e=B.imageUrlConfigs)||void 0===e?void 0:e.map(e=>{let{id:t,url:n}=e;return(0,r.jsx)(g.Z,{src:n,width:N,height:Z,alt:"圖片"},t)})}),(0,r.jsx)("p",{children:"回報描述"}),(0,r.jsx)("p",{children:null==B?void 0:B.describe}),null==B?void 0:null===(t=B.replyConfigs)||void 0===t?void 0:t.map(e=>{let{id:t,operator:n,operateTime:a,reply:o}=e;return(0,r.jsx)(T,{time:a,account:n,children:o},t)}),(0,r.jsxs)(y.Z,{onSubmit:Q,children:[(0,r.jsx)(x.Z,{value:O,onChange:V,disabled:A}),(0,r.jsx)(h.Z,{htmlType:"submit",loading:A,children:"回覆"})]})]})})]})});I.displayName="RestorationPage";var M=I},5493:function(e,t,n){"use strict";var r=n(9268),a=n(6006),o=n(4308),i=n(6361),s=n.n(i),c=n(8683),l=n.n(c),u=n(4507);let d=(0,a.memo)(e=>{let{children:t,loading:n,disabled:a,htmlType:i,onClick:c,looks:d}=e;return(0,r.jsxs)("button",{className:l()(s().button,{[s().dark]:d===u.L.dark}),disabled:n||a,onClick:c,type:i,children:[n&&(0,r.jsx)(o.Z,{size:o.v.small})," ",t]})});d.displayName="Button",t.Z=d},7454:function(e,t,n){"use strict";var r=n(9268),a=n(6394),o=n.n(a),i=n(6006),s=n(7613),c=n.n(s);let l=(0,i.memo)((0,i.forwardRef)((e,t)=>{let{src:n,...a}=e;return(0,r.jsx)(o(),{...a,ref:t,unoptimized:!0,src:"string"==typeof n&&n.startsWith("/")&&c().basePath?"".concat(c().basePath).concat(n):n})}));l.displayName="CustomImage",t.Z=l},2392:function(e,t,n){"use strict";n.d(t,{S:function(){return r}});var r,a=n(9268),o=n(6006),i=n(192),s=n.n(i),c=n(8683),l=n.n(c),u=n(956),d=n(5528);(r||(r={})).horizontal="horizontal";let m=(0,o.memo)(e=>{let{layout:t,onSubmit:n,children:i}=e,[c,m]=(0,o.useState)(!1);return(0,a.jsx)("form",{className:l()({[s().horizontal]:t===r.horizontal}),onSubmit:async e=>{if(e.preventDefault(),!c&&n){m(!0);try{n instanceof u.sG?await n():n()}catch(e){e instanceof Error?(0,u.cM)(e.message,d.L.console):(0,u.cM)(e,d.L.console)}finally{m(!1)}}},children:i})});m.displayName="Form",t.Z=m},6917:function(e,t,n){"use strict";var r=n(9268),a=n(6006),o=n(7394),i=n.n(o);let s=(0,a.memo)((0,a.forwardRef)((e,t)=>{let{type:n,value:o,onChange:s,onKeyDown:c,disabled:l,placeholder:u}=e,[d,m]=(0,a.useState)(o||"");return(0,r.jsx)("input",{className:i().input,type:n,value:d,onChange:e=>{let t=e.target.value;m(t),null==s||s(t)},onKeyDown:c,disabled:l,placeholder:u,ref:t})}));s.displayName="Input",t.Z=s},9333:function(e,t,n){"use strict";var r=n(9268),a=n(6006),o=n(8431),i=n(4674),s=n.n(i),c=n(5493);let l=(0,a.memo)(e=>{let{children:t,open:n=!1,maskClosable:a=!0,onClose:i}=e;return n&&(0,o.createPortal)((0,r.jsx)("div",{className:s().backgroundMask,onClick:a?i:void 0,children:(0,r.jsx)("div",{className:s().modal,onClick:e=>{e.stopPropagation()},children:(0,r.jsx)("div",{children:t})})}),document.body)});l.displayName="Modal";let u=(0,a.memo)(e=>{let{content:t,onOk:n,onCancel:o}=e,[i,s]=(0,a.useState)(!1),[u,d]=(0,a.useState)(!1),m=(0,a.useCallback)(async()=>{s(!0),await (null==n?void 0:n()),s(!1)},[n]),p=(0,a.useCallback)(async()=>{d(!0),await (null==o?void 0:o()),d(!1)},[o]);return(0,r.jsxs)(l,{children:[t,(0,r.jsx)(c.Z,{loading:i,disabled:u,onClick:m,children:"確定"}),(0,r.jsx)(c.Z,{loading:u,disabled:i,onClick:p,children:"取消"})]})});u.displayName="ConfirmModal",l.confirm=e=>{let{content:t,onOk:n,onCancel:r}=e;document.body},t.Z=l},4308:function(e,t,n){"use strict";n.d(t,{v:function(){return a}});var r,a,o=n(9268),i=n(6006),s=n(6753),c=n.n(s),l=n(8683),u=n.n(l);(r=a||(a={})).small="small",r.medium="medium";let d=(0,i.memo)(e=>{let{spinning:t=!0,size:n=a.medium,expand:r=!1,children:i}=e;return t?(0,o.jsxs)("div",{className:u()(c().wrapper,{[c().expand]:r},{[c().small]:n===a.small,[c().medium]:n===a.medium}),children:[i,(0,o.jsx)("div",{className:u()(c().overlay,{[c().block]:!i}),children:(0,o.jsx)("div",{className:c().spinner})})]}):i});d.displayName="Spin",t.Z=d},6519:function(e,t,n){"use strict";var r=n(9268),a=n(6006),o=n(6462),i=n(4308);let s=(0,a.memo)(e=>{let{rowKeyName:t="id",columns:n=[],dataSource:s=[],loading:c=!1}=e,l=(0,a.useMemo)(()=>n.map(e=>[e.dataIndex||(0,o.Z)(),e]),[n]),u=(0,a.useMemo)(()=>(0,r.jsx)("tr",{children:l.map(e=>{let[t,{title:n}]=e;return(0,r.jsx)("th",{children:n},t)})}),[l]),d=(0,a.useMemo)(()=>s.map(e=>(0,r.jsx)("tr",{children:l.map(t=>{let[n,{dataIndex:a,render:o}]=t;return(0,r.jsx)("td",{children:o?o(a&&e[a],e):a&&e[a]},n)})},e[t])),[l,s,t]);return(0,r.jsx)(i.Z,{spinning:c,children:(0,r.jsx)("table",{children:(0,r.jsxs)("tbody",{children:[u,d]})})})});s.displayName="Table",t.Z=s},1904:function(e,t,n){"use strict";n.d(t,{Q:function(){return a}});var r=n(6006);function a(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{manual:!0},n=(0,r.useRef)(t.manual),[a,o]=(0,r.useState)({loading:!1,data:void 0}),i=(0,r.useCallback)(async function(){for(var t=arguments.length,n=Array(t),r=0;r<t;r++)n[r]=arguments[r];o(e=>{let{data:t}=e;return{loading:!0,data:t}});let a=await e(...n);return o({loading:!1,data:a}),a},[e]),s=(0,r.useRef)(i);return(0,r.useEffect)(()=>{n.current||s.current(...[])},[]),(0,r.useMemo)(()=>({run:i,...a}),[i,a])}},7613:function(e){"use strict";e.exports={output:"export"}},5528:function(e,t,n){"use strict";var r,a;n.d(t,{L:function(){return r}}),(a=r||(r={})).none="none",a.console="console",a.message="message"},4507:function(e,t,n){"use strict";var r;n.d(t,{L:function(){return r}}),(r||(r={})).dark="dark"},2105:function(e,t,n){"use strict";n.d(t,{FH:function(){return r},M7:function(){return o},px:function(){return a}});let r="https://oldcity-backend.azurewebsites.net",a="token",o=!1},956:function(e,t,n){"use strict";n.d(t,{cM:function(){return o},gw:function(){return a},sG:function(){return i}});var r=n(5528);let a=async e=>{await new Promise(t=>setTimeout(t,e))},o=(e,t)=>{switch(t){case r.L.none:break;case r.L.console:case r.L.message:console.log(e)}},i=(async()=>{}).constructor},9236:function(e){e.exports={imageWidth:"30",imageHeight:"30"}},6361:function(e){e.exports={button:"Button_button__9tXVr",dark:"Button_dark__TmCnt"}},192:function(e){e.exports={horizontal:"Form_horizontal__tFVob"}},7394:function(e){e.exports={input:"Input_input__X23Vo"}},4674:function(e){e.exports={backgroundMask:"Modal_backgroundMask__2hKBY",modal:"Modal_modal___lQCY"}},6753:function(e){e.exports={wrapper:"Spin_wrapper__jzwXV",expand:"Spin_expand__ESZgo",overlay:"Spin_overlay__7NIg6",block:"Spin_block__72E_5",spinner:"Spin_spinner__kje4B",spin:"Spin_spin__rqgOI",small:"Spin_small__nDrTw",medium:"Spin_medium__hCyU7"}},6462:function(e,t,n){"use strict";let r;n.d(t,{Z:function(){return l}});let a="undefined"!=typeof crypto&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);var o={randomUUID:a};let i=new Uint8Array(16);function s(){if(!r&&!(r="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)))throw Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return r(i)}let c=[];for(let e=0;e<256;++e)c.push((e+256).toString(16).slice(1));var l=function(e,t,n){if(o.randomUUID&&!t&&!e)return o.randomUUID();e=e||{};let r=e.random||(e.rng||s)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t){n=n||0;for(let e=0;e<16;++e)t[n+e]=r[e];return t}return function(e,t=0){return(c[e[t+0]]+c[e[t+1]]+c[e[t+2]]+c[e[t+3]]+"-"+c[e[t+4]]+c[e[t+5]]+"-"+c[e[t+6]]+c[e[t+7]]+"-"+c[e[t+8]]+c[e[t+9]]+"-"+c[e[t+10]]+c[e[t+11]]+c[e[t+12]]+c[e[t+13]]+c[e[t+14]]+c[e[t+15]]).toLowerCase()}(r)}}},function(e){e.O(0,[720,253,488,744],function(){return e(e.s=9189)}),_N_E=e.O()}]);